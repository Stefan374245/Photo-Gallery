<div class="upload-container">
  <mat-card class="upload-card">
    <mat-card-header>
      <mat-card-title>Upload Photo</mat-card-title>
      <mat-card-subtitle>Share your amazing photos with the community</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <!-- File Upload Area -->
      <div class="file-upload-area" [class.has-file]="selectedFile">
        <div *ngIf="!selectedFile" class="upload-zone" (click)="fileInput.click()">
          <mat-icon class="upload-icon">cloud_upload</mat-icon>
          <h3>Click to select a photo</h3>
          <p>Or drag and drop an image file here</p>
          <p class="file-info">Supported formats: JPG, PNG, WebP (Max 10MB)</p>
        </div>

        <div *ngIf="selectedFile && previewUrl" class="preview-area">
          <div class="image-preview">
            <img [src]="previewUrl" [alt]="selectedFile.name" class="preview-image" aria-label="Selected photo preview">
            <button mat-icon-button class="remove-btn" (click)="removeSelectedFile()">
              <mat-icon>close</mat-icon>
            </button>
          </div>
          <div class="file-details">
            <p><strong>{{ selectedFile.name }}</strong></p>
            <p>{{ (selectedFile.size / 1024 / 1024).toFixed(2) }} MB</p>
          </div>
        </div>

        <input #fileInput type="file" accept="image/*" (change)="onFileSelected($event)" hidden>
      </div>

      <!-- Upload Form -->
      <form [formGroup]="uploadForm" (ngSubmit)="onSubmit()" class="upload-form">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Photo Title</mat-label>
          <input matInput [formControl]="titleControl" placeholder="Enter a title for your photo">
          <mat-error *ngIf="titleControl.invalid && titleControl.touched">
            {{ getTitleErrorMessage() }}
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Description (Optional)</mat-label>
          <textarea matInput [formControl]="descriptionControl" placeholder="Tell us about this photo..." rows="3"></textarea>
          <mat-error *ngIf="descriptionControl.invalid && descriptionControl.touched">
            {{ getDescriptionErrorMessage() }}
          </mat-error>
        </mat-form-field>

        <!-- Upload Progress -->
        <div *ngIf="isUploading$ | async" class="upload-progress">
          <p>Uploading your photo...</p>
          <mat-progress-bar mode="determinate" [value]="uploadProgress$ | async"></mat-progress-bar>
          <p class="progress-text">{{ (uploadProgress$ | async) | number:'1.0-0' }}%</p>
        </div>

        <!-- Action Buttons -->
        <div class="form-actions">
          <button mat-stroked-button type="button" routerLink="/gallery">
            Cancel
          </button>
          <button 
            mat-raised-button 
            color="primary" 
            type="submit" 
            [disabled]="uploadForm.invalid || !selectedFile || (isUploading$ | async)">
            <mat-icon>publish</mat-icon>
            Upload Photo
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>